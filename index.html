<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <title>Salle d'escalade de Beaulieu</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <meta name="author" content="Eol Gueguen--Vincent" />
  </head>
  <body>
    <header>
      <h1 id="titre">Salle d'escalade de Beaulieu</h1>
      <div id="auth-container">
        <div id="auth-form" class="auth-form">
          <input type="email" id="email" placeholder="Email" />
          <input type="password" id="password" placeholder="Mot de passe" />
          <button onclick="signIn()">Se connecter</button>
          <button onclick="signUp()">S'inscrire</button>
        </div>
        <div id="user-info" style="display: none">
          <span id="user-email"></span>
          <button onclick="signOut()" class="signout-btn">
            Se déconnecter
          </button>
        </div>
      </div>
    </header>

    <main class="bloc-list">
      <div class="bloc" onclick="openLightbox('Images/bloc1.jpg')">
        <img src="Images/bloc1.jpg" alt="Bloc 1" />
        <div class="bloc-info">Bloc 1 - V2</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc2.jpg')">
        <img src="Images/bloc2.jpg" alt="Bloc 2" />
        <div class="bloc-info">Bloc 2 - V4</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc3.jpg')">
        <img src="Images/bloc3.jpg" alt="Bloc 3" />
        <div class="bloc-info">Bloc 3 - V3</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc4.jpg')">
        <img src="Images/bloc4.jpg" alt="Bloc 4" />
        <div class="bloc-info">Bloc 4 - V5</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc5.jpg')">
        <img src="Images/bloc5.jpg" alt="Bloc 5" />
        <div class="bloc-info">Bloc 5 - V6</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc6.jpg')">
        <img src="Images/bloc6.jpg" alt="Bloc 6" />
        <div class="bloc-info">Bloc 6 - V3</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc7.jpg')">
        <img src="Images/bloc7.jpg" alt="Bloc 7" />
        <div class="bloc-info">Bloc 7 - V4</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc8.jpg')">
        <img src="Images/bloc8.jpg" alt="Bloc 8" />
        <div class="bloc-info">Bloc 8 - V2</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc9.jpg')">
        <img src="Images/bloc9.jpg" alt="Bloc 9" />
        <div class="bloc-info">Bloc 9 - V1</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc10.jpg')">
        <img src="Images/bloc10.jpg" alt="Bloc 10" />
        <div class="bloc-info">Bloc 10 - V7</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc11.jpg')">
        <img src="Images/bloc11.jpg" alt="Bloc 11" />
        <div class="bloc-info">Bloc 11 - V6</div>
      </div>
      <div class="bloc" onclick="openLightbox('Images/bloc12.jpg')">
        <img src="Images/bloc12.jpg" alt="Bloc 12" />
        <div class="bloc-info">Bloc 12 - V5</div>
      </div>
    </main>

    <div id="lightbox" class="lightbox">
      <a href="#" class="close">&times;</a>
      <img id="lightbox-img" src="" alt="Bloc en grand" />
    </div>

    <script type="module">
      import { initializeApp } from 'firebase/app';
      import { getAuth } from 'firebase/auth';

      const firebaseConfig = {
        apiKey: 'AIzaSyD4qilE_HQzSTAD_2Qz4BLv90ilk4wYx3E',
        authDomain: 'salle-d-escalade.firebaseapp.com',
        projectId: 'salle-d-escalade',
        storageBucket: 'salle-d-escalade.firebasestorage.app',
        messagingSenderId: '866773882445',
        appId: '1:866773882445:web:fa0ea26224e1424dd72e04',
      };

      const app = initializeApp(firebaseConfig);
      export const auth = getAuth(app);

      import {
        signInWithEmailAndPassword,
        createUserWithEmailAndPassword,
        signOut as firebaseSignOut,
      } from 'firebase/auth';

      window.openLightbox = function (imageSrc) {
        const lightbox = document.getElementById('lightbox');
        const img = document.getElementById('lightbox-img');
        img.src = imageSrc;
        lightbox.style.display = 'flex';
      };

      window.signIn = async function () {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        try {
          await signInWithEmailAndPassword(auth, email, password);
          alert('Connexion réussie !');
        } catch (error) {
          alert('Erreur de connexion : ' + error.message);
        }
      };

      window.signUp = async function () {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        try {
          await createUserWithEmailAndPassword(auth, email, password);
          alert('Inscription réussie !');
        } catch (error) {
          alert("Erreur d'inscription : " + error.message);
        }
      };

      window.signOut = async function () {
        try {
          await firebaseSignOut(auth);
          alert('Déconnexion réussie !');
        } catch (error) {
          alert('Erreur de déconnexion : ' + error.message);
        }
      };

      auth.onAuthStateChanged((user) => {
        const authForm = document.getElementById('auth-form');
        const userInfo = document.getElementById('user-info');
        const userEmail = document.getElementById('user-email');

        if (user) {
          authForm.style.display = 'none';
          userInfo.style.display = 'flex';
          userEmail.textContent = `Connecté en tant que : ${user.email}`;
        } else {
          authForm.style.display = 'flex';
          userInfo.style.display = 'none';
        }
      });

      document
        .querySelector('.lightbox')
        .addEventListener('click', function (e) {
          if (e.target === this || e.target.classList.contains('close')) {
            this.style.display = 'none';
          }
        });

      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape') {
          const lightbox = document.getElementById('lightbox');
          lightbox.style.display = 'none';
        }
      });
    </script>
  </body>
</html>
